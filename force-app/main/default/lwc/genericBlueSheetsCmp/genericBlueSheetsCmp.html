<template>
    <lightning-layout vertical-align="center">
        <lightning-layout-item flexibility="auto" padding="around-small" size="12" medium-device-size="6" class="inline-layout">
            <img src={strengthImage} alt="Strength Image" class="icon-image"/><p><b>  Red Flag: </b>Uncovered Base, New Players/Reorganization, Uncertainty/Lack of Data</p>
        </lightning-layout-item>
        <lightning-layout-item flexibility="auto" padding="around-small" size="12" medium-device-size="6" class="inline-layout">
            <img src={redFlagImage} alt="Red Flag Image" class="icon-image"/> <p><b>  Strengths: </b>Areas of differentiation; Opportunities to improve your position</p>
        </lightning-layout-item>
    </lightning-layout>
    <lightning-layout vertical-align="center" class="slds-m-top_medium">
        <lightning-layout-item flexibility="auto" padding="around-small" size="12" medium-device-size="6">
            <div class="slds-combobox_container">
                <div class="slds-form-element">
                    <legend style="color: #040507">Sales Person Involved</legend>
                    <div class="slds-form-element__control">
                        <div class="slds-combobox_container" aria-expanded="true" aria-haspopup="listbox" role="combobox">
                            <div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click slds-is-open">
                                <template if:false={selectedValue}>
                                    <div class="slds-p-top_none">
                                        <lightning-input type="search" value={searchKey} onchange={handleKeyChange} variant="label-hidden" class="requiredfield resetfields" message-when-value-missing="Please Select a User" autocomplete="off" placeholder="Search Users..">
                                        </lightning-input>
                                        <div if:true={showSpinner}>
                                            <lightning-spinner alternative-text="Loading" size="small"></lightning-spinner>
                                        </div>
                                    </div>
                                </template>
                                <template if:true={selectedValue}>
                                    <div class="slds-pill_container">
                                        <lightning-pill class="pillSize" label={notifyName} name={notifyName} onremove={handleRemovePill}>
                                            <lightning-icon icon-name="standard:avatar" alternative-text="pillicon"></lightning-icon>
                                        </lightning-pill>
                                    </div>
                                </template>
                                <template if:true={showDropDown}>
                                    <div class="slds-dropdown slds-dropdown_length-5 slds-dropdown_fluid scroll-1">
                                        <ul class="slds-listbox slds-listbox_vertical recordListBox">
                                            <template if:false={message}>
                                                <template for:each={recordsList} for:item="user">
                                                    <li key={user.Id} class="slds-listbox__item" onclick={onSelect} data-id={user.Id} role="presentation" data-name={user.Name} data-role={user.Name}>
                                                        <div aria-selected="true" id={user.Id} class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_has-meta" role="option" tabindex="0">
                                                            <span class="slds-media__figure">
                                                                <span class="slds-icon_container slds-icon-standard-avatar">
                                                                    <lightning-icon icon-name="standard:avatar" size="small"></lightning-icon>
                                                                </span>
                                                            </span>
                                                            <span class="slds-media__body">
                                                                <span class="slds-listbox__option-text slds-listbox__option-text_entity">{user.Name}</span>
                                                            </span>
                                                        </div>
                                                    </li>
                                                </template>
                                            </template>
                                            <template if:true={message}>
                                                <li class="slds-listbox__item">
                                                    <span class="slds-media slds-listbox__option_entity">{message}</span>
                                                </li>
                                            </template>
                                        </ul>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </lightning-layout-item>
        <lightning-layout-item flexibility="auto" padding="around-small" size="12" medium-device-size="6">
            <lightning-combobox label="Adequacy of current position" name="adequacyOfCurrentPosition" value={adequacyOfCurrentPosition} options={adequacyOption} onchange={handleChange}></lightning-combobox>
        </lightning-layout-item>
    </lightning-layout>
    
    <!-- Same for textareas -->
    <lightning-layout vertical-align="center" class="slds-m-top_medium">
        <lightning-layout-item flexibility="auto" padding="around-small" size="12" medium-device-size="6">
            <lightning-textarea name="currentVolume" label="Current Volume(Daily load in Ton)" value={currentVolume} onchange={handleChange}></lightning-textarea>
        </lightning-layout-item>
        <lightning-layout-item flexibility="auto" padding="around-small" size="12" medium-device-size="6">
            <lightning-textarea name="totalPotentialVolume" label="Total Potential Volume(Daily load in Ton)" value={totalPotentialVolume} onchange={handleChange}></lightning-textarea>
        </lightning-layout-item>
    </lightning-layout>
    
    <lightning-layout vertical-align="center" class="slds-m-top_medium">
        <lightning-layout-item flexibility="auto" padding="around-small" size="12" medium-device-size="6">
            <lightning-textarea name="productService" label="Product/Service" value={productService} onchange={handleChange}></lightning-textarea>
        </lightning-layout-item>
        <lightning-layout-item flexibility="auto" padding="around-small" size="12" medium-device-size="6">
            <lightning-textarea name="salesRevenueUnit" label="Sales Revenue/Units" value={salesRevenueUnit} onchange={handleChange}></lightning-textarea>
        </lightning-layout-item>
    </lightning-layout>
    
    <!-- Date fields -->
    <lightning-layout vertical-align="center" class="slds-m-top_medium">
        <lightning-layout-item flexibility="auto" padding="around-small" size="12" medium-device-size="6">
            <lightning-input type="text" label="Created Date" name="createdDate" value={formattedCreatedDate} disabled="true"></lightning-input>
        </lightning-layout-item>
        <lightning-layout-item flexibility="auto" padding="around-small" size="12" medium-device-size="6">
            <lightning-input type="text" label="Last Modified Date" name="lastModifyDate" value={formattedLastModifiedDate} disabled="true"></lightning-input>
        </lightning-layout-item>
    </lightning-layout>
    
    <!-- Competitor Details -->
    <div class="slds-section slds-is-open">
        <h3 class="slds-section__title">
            <button aria-expanded="true" class="slds-button slds-section__title-action">
                <span class="slds-truncate" title="Section Title">Competitor Detail</span>
            </button>
        </h3>
        <div class="slds-section__content">
            <lightning-layout vertical-align="center" class="slds-m-top_medium">
                <lightning-layout-item flexibility="auto" padding="around-small" size="12" medium-device-size="6">
                    <lightning-combobox label="Competition Type" name="competitorDetails" value={competitorDetails} options={CompetitorOptions} onchange={handleChange}></lightning-combobox>
                </lightning-layout-item>
                <lightning-layout-item flexibility="auto" padding="around-small" size="12" medium-device-size="6">
                    <lightning-input type="text" label="Specify Competitor(s)" name="specifyCompetitor" value={specifyCompetitor} onchange={handleChange}></lightning-input>
                </lightning-layout-item>
            </lightning-layout>
    
            <lightning-layout vertical-align="center" class="slds-m-top_medium">
                <lightning-layout-item flexibility="auto" padding="around-small" size="12" medium-device-size="6">
                    <lightning-combobox label="My Position vs. Competition" name="myPositionVsCompetition" value={myPositionVsCompetition} options={myPositionOption} onchange={handleChange}></lightning-combobox>
                </lightning-layout-item>
                <lightning-layout-item flexibility="auto" padding="around-small" size="12" medium-device-size="6">
                    <lightning-combobox label="Place in Sales Funnel" name="placeInSalesFunnel" value={placeInSalesFunnel} options={salesTunnelOption} onchange={handleChange}></lightning-combobox>
                </lightning-layout-item>
            </lightning-layout>
    
            <lightning-layout vertical-align="center" class="slds-m-top_medium">
                <lightning-layout-item flexibility="auto" padding="around-small" size="12" medium-device-size="6">
                    <lightning-combobox label="Timing For Priorities" name="timingForPriorities" value={timingForPriorities} options={timingPrioritiesOption} onchange={handleChange}></lightning-combobox>
                </lightning-layout-item>
            </lightning-layout>
        </div>
    </div>
    

    <lightning-layout vertical-align="center" class="slds-m-top_medium slds-wrap">
        <lightning-layout-item class="slds-size_12-of-12 slds-small-size_12-of-12">
            <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                <thead>
                    <tr class="slds-line-height_reset">
                        <th scope="col" style="width: 40px; min-width: 40px; max-width: 40px;"> <!-- Adjust width as needed -->
                            <div class="slds-truncate" title="Flag">Flag</div>
                        </th>
                        <th scope="col">                            
                            <div class="slds-truncate" title="Column Header">Ideal Customer Criteria</div>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate" title="Column Header">Match to Criteria (-5 to +5)</div>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate" title="Column Header">Action</div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <template for:each={tableData3} for:item="row" for:index="index">
                        <tr key={row.id}>
                                <td data-label="Flag" >
                                    <lightning-combobox name="role" value={row.flag} options={flagOptions}
                                        onchange={handleFlagChange} data-index={index} data-id={row.id} data-table="tableData3">
                                    </lightning-combobox>
                                </td>
                            <td data-label="Ideal Customer Criteria">
                                <lightning-textarea name="col1" value={row.idealCustomerCriteria}
                                    onchange={handleIdeal}
                                    data-id={row.id} data-index={index} data-table="tableData3">
                                </lightning-textarea>
                            </td>
                            <td data-label="Match Criteria">
                                <lightning-combobox name="role" value={row.matchCriteria} options={ratingOptions}
                                    onchange={handleMatchRating} data-index={index} data-id={row.id} data-table="tableData3">
                                </lightning-combobox>
                            </td>
                            <td data-label="Actions" style="text-align: center;">
                                <lightning-button-icon icon-name="utility:add" alternative-text="Add Row"
                                    title="Add Row" onclick={addRow3} data-index={index}>
                                </lightning-button-icon>
                                &nbsp;&nbsp;
                                <template if:true={row.cstnBtn}>
                                    <lightning-button-icon icon-name="utility:delete" alternative-text="Delete Row"
                                        title="Delete Row" onclick={deleteRow3} access-key={row.id}
                                        rec-id={row.recId} id={index} data-index={index}>
                                    </lightning-button-icon>
                                </template>
                            </td>
                        </tr>
                    </template>
                </tbody>
            </table>
        </lightning-layout-item>
    </lightning-layout>
    
    
    <lightning-layout class="slds-m-top_medium slds-wrap">
        <lightning-layout-item class="slds-size_12-of-12 slds-small-size_12-of-12">
            <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                <thead>
                    <tr class="slds-line-height_reset">
                        <th scope="col" style="width: 40px; min-width: 40px; max-width: 40px;"> <!-- Adjust width as needed -->
                            <div class="slds-truncate" title="Flag">Flag</div>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate" title="Column Header">Buying Influences Involved</div>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate" title="Column Header">Role</div>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate" title="Column Header">Degree of Influence</div>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate" title="Column Header">Mode</div>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate" title="Column Header">Buying Influence Key Win-Results</div>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate" title="Column Header">Rating(-5 to +5)</div>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate" title="Column Header">Evidence to support your Rating</div>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate" title="Column Header">Action</div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <template for:each={tableData} for:item="row" for:index="index">
                        <tr key={row.id}>
                            <td data-label="Flag" >
                                <lightning-combobox name="role" value={row.flag} options={flagOptions}
                                    onchange={handleFlagChange} data-index={index} data-id={row.id} data-table="tableData">
                                </lightning-combobox>
                            </td>
                            <td data-label="Column 1">
                                <!-- Buy Contact Search -->
                                <div class="slds-combobox_container">
                                    <div class="slds-form-element">
                                        <div class="slds-form-element__control">
                                            <div class="slds-combobox_container" aria-expanded="true" aria-haspopup="listbox" role="combobox">
                                                <div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click slds-is-open">
                                                    <template if:false={row.selectedValue}>
                                                        <div class="slds-p-top_none">
                                                            <lightning-input type="search" value={row.searchBuyKey} onchange={handleBuyKeyChange} variant="label-hidden" class="requiredfield resetfields" message-when-value-missing="Please select a contact" autocomplete="off" placeholder="Search Contacts.." data-index={index}>
                                                            </lightning-input>
                                                            <div if:true={row.showBuySpinner}>
                                                                <lightning-spinner alternative-text="Loading" size="small"></lightning-spinner>
                                                            </div>
                                                        </div>
                                                    </template>
                                                    <template if:true={row.selectedValue}>
                                                        <div class="slds-pill_container">
                                                            <lightning-pill class="pillSize" label={row.buyingInfluenceName} name={row.buyingInfluenceName} onremove={handleRemoveBuyPill} data-index={index}>
                                                                <lightning-icon icon-name="standard:avatar" alternative-text="pill icon"></lightning-icon>
                                                            </lightning-pill>
                                                        </div>
                                                    </template>
                                                    <template if:true={row.showBuyDropDown}>
                                                        <div class="slds-dropdown slds-dropdown_length-5 slds-dropdown_fluid scroll-1">
                                                            <ul class="slds-listbox slds-listbox_vertical recordListBox">
                                                                <template for:each={row.recordsBuyList} for:item="user">
                                                                    <li key={user.Id} class="slds-listbox__item" onclick={OnBuySelect} data-id={user.Id} role="presentation" data-name={user.Name} data-role={user.Name} data-index={index}>
                                                                        <div aria-selected="true" id={user.Id} class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_has-meta" role="option" tabindex="0">
                                                                            <span class="slds-media__figure">
                                                                                <span class="slds-icon_container slds-icon-standard-avatar">
                                                                                    <lightning-icon icon-name="standard:avatar" size="small"></lightning-icon>
                                                                                </span>
                                                                            </span>
                                                                            <span class="slds-media__body">
                                                                                <span class="slds-listbox__option-text_entity">{user.Name}</span>
                                                                            </span>
                                                                        </div>
                                                                    </li>
                                                                </template>
                                                                <template if:true={row.buyMessage}>
                                                                    <li class="slds-listbox__item">
                                                                        <span class="slds-media slds-listbox__option_entity">{row.buyMessage}</span>
                                                                    </li>
                                                                </template>
                                                            </ul>
                                                        </div>
                                                    </template>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                            <td data-label="Column 2">
                                <lightning-combobox name="role" options={roleOptions} value={row.role} onchange={handleRole} data-id={row.id} data-index={index} data-table="tableData"></lightning-combobox>
                            </td>
                            <td data-label="Column 3">
                                <lightning-combobox name="degreeOfInfluence" options={degreeOption} value={row.degreeOfInfluence} onchange={handleDegreeOfInfluence} data-id={row.id} data-index={index} data-table="tableData"></lightning-combobox>
                            </td>
                            <td data-label="Column 4">
                                <lightning-combobox name="mode" options={modeOption} value={row.mode} onchange={handleMode} data-id={row.id} data-index={index} data-table="tableData"></lightning-combobox>
                            </td>
                            <td data-label="Column 5">
                                <lightning-textarea onchange={handleWinResults} value={row.winResult} data-id={row.id} data-index={index} data-table="tableData"></lightning-textarea>
                            </td>
                            <td data-label="Column 6">
                                <lightning-combobox name="role" value={row.rating} options={ratingOptions} onchange={handleRating} data-index={index} data-id={row.id} data-table="tableData"></lightning-combobox>
                            </td>
                            <td data-label="Column 7">
                                <lightning-textarea name="col1" value={row.evidenceRating} onchange={handleEvidence} data-id={row.id} data-index={index} data-table="tableData"></lightning-textarea>
                            </td>
                            <td data-label="Actions" style="text-align: center;">
                                <div class="slds-m-top_medium">
                                    <lightning-button-icon icon-name="utility:add" alternative-text="Add Row" title="Add Row" onclick={addRow} data-index={index}></lightning-button-icon>
                                    &nbsp;&nbsp;
                                    <template if:true={row.cstnBtn}>
                                        <lightning-button-icon icon-name="utility:delete" alternative-text="Delete Row" title="Delete Row" onclick={deleteRow} access-key={row.id} rec-id={row.recId} id={index} data-index={index}></lightning-button-icon>
                                    </template>
                                </div>
                            </td>
                        </tr>
                    </template>
                </tbody>
            </table>
        </lightning-layout-item>
    </lightning-layout>
    



<!--New Table added by Atul for Strength-->
<lightning-layout vertical-align="center" class="slds-m-top_small slds-wrap">
    <table class="slds-table slds-table_resizable-cols slds-table_cell-buffer slds-table_bordered slds-table_stacked-horizontal">
        <thead>
            <tr style="height: 26px;">
                <th colspan="1"><div style="max-height: 52px;">SUMMARY OF MY POSITION TODAY</div></th>
                <th rowspan="2"><div style="max-height: 78px;"><span style="font-size: 10pt;">POSSIBLE ACTIONS<br></span></div></th>
                <th colspan="3"><div style="max-height: 52px;">BEST ACTION PLAN</div></th>
                <th rowspan="2"><div style="max-height: 52px;">Action</div></th>
            </tr>
            <tr style="height: 26px;">
                <th colspan="1"><div style="max-height: 52px;">STRENGTHS</div></th>
                <th><div style="max-height: 52px;">What</div></th>
                <th><div style="max-height: 52px;">Who</div></th>
                <th><div style="max-height: 52px;">When</div></th>
            </tr>
        </thead>
        <tbody>
            <!-- Iterating over rows -->
            <template for:each={tableData4} for:item="row" for:index="index">
                <tr key={row.id}>
                    <td data-label="Column 1">
                        <lightning-textarea name="col1" value={row.summryOfMyPosition} onchange={handlesummryOfMyPosition} data-id={row.id} data-index={index} data-table="tableData4"></lightning-textarea>
                    </td>
                    <td data-label="Column 1">
                        <lightning-textarea name="col1" value={row.possibleActions} onchange={handlepossibleActions} data-id={row.id} data-index={index} data-table="tableData4"></lightning-textarea>
                    </td>
                    <td>
                        <lightning-textarea name="col1" value={row.what} onchange={handlewhat} data-id={row.id} data-index={index} data-table="tableData4"></lightning-textarea>
                    </td>
                    <td>
                        <div class="slds-combobox_container">
                            <div class="slds-form-element">
                                <div class="slds-form-element__control">
                                    <div class="slds-combobox_container" aria-expanded="true" aria-haspopup="listbox" role="combobox">
                                        <div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click slds-is-open">
                                            <template if:false={row.selectedValue}>
                                                <div class="slds-p-top_none">
                                                    <lightning-input type="search" value={row.searchWhoKey} onchange={handleWhoKeyChange} variant="label-hidden" class="requiredfield resetfields" message-when-value-missing="Please Select a User" autocomplete="off" placeholder="Search Users.." data-index={index}>
                                                    </lightning-input>
                                                    <div if:true={row.showWhoSpinner}>
                                                        <lightning-spinner alternative-text="Loading" size="small"></lightning-spinner>
                                                    </div>
                                                </div>
                                            </template>
                                            <template if:true={row.selectedValue}>
                                                <div class="slds-pill_container">
                                                    <lightning-pill class="pillSize" label={row.notifyName} name={row.notifyName} onremove={handleRemoveWhoPill} data-index={index}>
                                                        <lightning-icon icon-name="standard:avatar" alternative-text="pillicon"></lightning-icon>
                                                    </lightning-pill>
                                                </div>
                                            </template>
                                            <template if:true={row.showWhoDropDown}>
                                                <div class="slds-dropdown slds-dropdown_length-5 slds-dropdown_fluid scroll-1">
                                                    <ul class="slds-listbox slds-listbox_vertical recordListBox">
                                                        <template if:false={row.whoMessage}>
                                                            <template for:each={row.recordsWhoList} for:item="user">
                                                                <li key={user.Id} class="slds-listbox__item" onclick={onWhoSelect} data-id={user.Id} role="presentation" data-name={user.Name} data-role={user.Name} data-index={index}>
                                                                    <div aria-selected="true" id={user.Id} class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_has-meta" role="option" tabindex="0">
                                                                        <span class="slds-media__figure">
                                                                            <span class="slds-icon_container slds-icon-standard-avatar">
                                                                                <lightning-icon icon-name="standard:avatar" size="small"></lightning-icon>
                                                                            </span>
                                                                        </span>
                                                                        <span class="slds-media__body">
                                                                            <span class="slds-listbox__option-text_entity">{user.Name}</span>
                                                                        </span>
                                                                    </div>
                                                                </li>
                                                            </template>
                                                        </template>
                                                        <template if:true={row.whoMessage}>
                                                            <li class="slds-listbox__item">
                                                                <span class="slds-media slds-listbox__option_entity">{row.whoMessage}</span>
                                                            </li>
                                                        </template>
                                                    </ul>
                                                </div>
                                            </template>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                                        
                    <td>
                        <lightning-input type="date" name="when" value={row.whenDate} onchange={handlewhen} data-id={row.id} data-index={index} data-table="tableData4"></lightning-input> 
                    </td>
                    <td style="text-align: center;">
                        <lightning-button-icon icon-name="utility:add" alternative-text="Add Row" title="Add Row" onclick={addRow4} data-index={index}></lightning-button-icon>
                        <template if:true={row.cstnBtn}>
                            <lightning-button-icon icon-name="utility:delete" alternative-text="Delete Row" title="Delete Row" onclick={deleteRow4} access-key={row.id} rec-id={row.recId} id={index} data-index={index}></lightning-button-icon>
                        </template>
                    </td>
                </tr>
            </template>
        </tbody>
    </table>
</lightning-layout>

<!-- New Table for Red Flag Section -->
<lightning-layout vertical-align="center" class="slds-m-top_small slds-wrap">
    <table class="slds-table slds-table_resizable-cols slds-table_cell-buffer slds-table_bordered slds-table_stacked-horizontal">
        <thead>
            <tr style="height: 26px;">
                <th colspan="1"><div style="max-height: 52px;">SUMMARY OF MY POSITION TODAY</div></th>
                <th rowspan="2"><div style="max-height: 78px;"><span style="font-size: 10pt;">POSSIBLE ACTIONS<br></span></div></th>
                <th colspan="3"><div style="max-height: 52px;">BEST ACTION PLAN</div></th>
                <th rowspan="2"><div style="max-height: 52px;">Action</div></th>
            </tr>
            <tr style="height: 26px;">
                <th colspan="1"><div style="max-height: 52px;">RED FLAGS</div></th>
                <th colspan="2"><div style="max-height: 52px;">Information Needed</div></th>
                <th><div style="max-height: 52px;">From Whom</div></th>
            </tr>
        </thead>
        <tbody>
            <template for:each={tableData5} for:item="row" for:index="index">
                <tr key={row.id}>
                    <td data-label="Column 1">
                        <lightning-textarea name="col1" value={row.summryOfMyPosition} onchange={handlesummryOfMyPosition} data-id={row.id} data-index={index} data-table="tableData5"></lightning-textarea>
                    </td>
                    <td data-label="Column 1">
                        <lightning-textarea name="col1" value={row.possibleActions} onchange={handlepossibleActions} data-id={row.id} data-index={index} data-table="tableData5"></lightning-textarea>
                    </td>
                    <td colspan="2">
                        <lightning-textarea name="col1" value={row.informationNeeded} onchange={handleinformationNeeded} data-id={row.id} data-index={index} data-table="tableData5"></lightning-textarea>
                    </td>
                    <td>
                        <div class="slds-combobox_container">
                            <div class="slds-form-element">
                                <div class="slds-form-element__control">
                                    <div class="slds-combobox_container" aria-expanded="true" aria-haspopup="listbox" role="combobox">
                                        <div class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click slds-is-open">
                                            <template if:false={row.selectedValue}>
                                                <div class="slds-p-top_none">
                                                    <lightning-input type="search" value={row.searchWhomKey} onchange={handleWhomKeyChange} variant="label-hidden" class="requiredfield resetfields" message-when-value-missing="Please Select a User" autocomplete="off" placeholder="Search Users.." data-index={index}>
                                                    </lightning-input>
                                                    <div if:true={row.showWhomSpinner}>
                                                        <lightning-spinner alternative-text="Loading" size="small"></lightning-spinner>
                                                    </div>
                                                </div>
                                            </template>
                                            <template if:true={row.selectedValue}>
                                                <div class="slds-pill_container">
                                                    <lightning-pill class="pillSize" label={row.notifyName} name={row.notifyName} onremove={handleRemoveWhomPill} data-index={index}>
                                                        <lightning-icon icon-name="standard:avatar" alternative-text="pillicon"></lightning-icon>
                                                    </lightning-pill>
                                                </div>
                                            </template>
                                            <template if:true={row.showWhomDropDown}>
                                                <div class="slds-dropdown slds-dropdown_length-5 slds-dropdown_fluid scroll-1">
                                                    <ul class="slds-listbox slds-listbox_vertical recordListBox">
                                                        <template if:false={row.whomMessage}>
                                                            <template for:each={row.recordsWhomList} for:item="user">
                                                                <li key={user.Id} class="slds-listbox__item" onclick={onWhomSelect} data-id={user.Id} role="presentation" data-name={user.Name} data-role={user.Name} data-index={index}>
                                                                    <div aria-selected="true" id={user.Id} class="slds-media slds-listbox__option slds-listbox__option_entity slds-listbox__option_has-meta" role="option" tabindex="0">
                                                                        <span class="slds-media__figure">
                                                                            <span class="slds-icon_container slds-icon-standard-avatar">
                                                                                <lightning-icon icon-name="standard:avatar" size="small"></lightning-icon>
                                                                            </span>
                                                                        </span>
                                                                        <span class="slds-media__body">
                                                                            <span class="slds-listbox__option-text slds-listbox__option-text_entity">{user.Name}</span>
                                                                        </span>
                                                                    </div>
                                                                </li>
                                                            </template>
                                                        </template>
                                                        <template if:true={row.whomMessage}>
                                                            <li class="slds-listbox__item">
                                                                <span class="slds-media slds-listbox__option_entity">{row.whomMessage}</span>
                                                            </li>
                                                        </template>
                                                    </ul>
                                                </div>
                                            </template>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                    <td style="text-align: center;">
                        <lightning-button-icon icon-name="utility:add" alternative-text="Add Row" title="Add Row" onclick={addRow5} data-index={index}></lightning-button-icon>
                        <template if:true={row.cstnBtn}>
                            <lightning-button-icon icon-name="utility:delete" alternative-text="Delete Row" title="Delete Row" onclick={deleteRow5} access-key={row.id} rec-id={row.recId} id={index} data-index={index}></lightning-button-icon>
                        </template>
                    </td>
                </tr>
            </template>
        </tbody>
    </table>
</lightning-layout>




</template>